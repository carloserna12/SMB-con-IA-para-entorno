using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using System;

[Serializable]
public class GameStateManager : MonoBehaviour {
	public bool spawnFromPoint;
	public int spawnPointIdx;
	public int spawnPipeIdx;

	public int marioSize;
	public int lives;
	public int coins;
	public int scores;
	public float timeLeft;
	public bool hurryUp;
	
	public string sceneToLoad; // what scene to load after level start screen finishes?
	public bool timeup;

	public int modifMap = 0;

    public int controlVelocidad = 3;
	
	public List<string> testApi = new List<string>();
	public int[,] editMarioWorld = new int[,] {  { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 12, 0, 0, 6, 0, 0, 0, 3, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 23, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 6, 12, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 6, 12, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0},
                                    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0},
                                    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0},
                                    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 7, 0, 0, 0, 3, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 3, 0, 0, 0, 4, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0},
                                    { 2, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0},
                                    { 2, 0, 12, 0, 0, 6, 0, 0, 0, 3, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 6, 0, 0, 0, 3, 0, 0, 0, 0},
                                    { 2, 0, 12, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
                                    { 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
	
	
	///////////////////////////////
	//Limitar fps a 100fps
	
	public List<Coordenadas> playerLevelData = new List<Coordenadas>();
	void Awake () {
		if (FindObjectsOfType (GetType ()).Length == 1) {
			DontDestroyOnLoad (gameObject);
			ConfigNewGame ();

			//Limitador de FPS
			Application.targetFrameRate = 100;
		} else {
			Destroy (gameObject);
		}
	}
	
	public void ResetSpawnPosition() {
		spawnFromPoint = true;
		spawnPointIdx = 0;
		spawnPipeIdx = 0;
	}

	public void SetSpawnPipe(int idx) {
		spawnFromPoint = false;
		spawnPipeIdx = idx;
	}

	public void ConfigNewGame() {
		marioSize = 0;
		lives = 3;
		coins = 0;
		scores = 0;
		timeLeft = 400.5f;
		hurryUp = false;
		ResetSpawnPosition ();
		sceneToLoad = null;
		timeup = false;
	}

	public void ConfigNewLevel() {
		timeLeft = 400.5f;
		hurryUp = false;
		ResetSpawnPosition ();
	}

	public void ConfigReplayedLevel() { // e.g. Mario respawns
		timeLeft = 400.5f;
		hurryUp = false;
	}

	public void SaveGameState() {
		LevelManager t_LevelManager = FindObjectOfType<LevelManager> ();
		marioSize = t_LevelManager.marioSize;
		lives = t_LevelManager.lives;
		coins = t_LevelManager.coins;
		scores = t_LevelManager.scores;
		timeLeft = t_LevelManager.timeLeft;
		hurryUp = t_LevelManager.hurryUp;
	}

}
